<div class="modal-header" *ngIf="data$ | async">
  <h6 class="modal-title pull-left">Validación de información</h6>
</div>
<div class="modal-body" *ngIf="data$ | async">
  <!-- General info -->
  <div id="container-general-info">
    <p class="text-info font-weight-bold">Informacion general</p>
    <div id="list-container" class="d-lg-flex">
      <ul class="list-unstyled d-inline-block">
        <li class="d-flex justify-content-between">
          <span class="font-weight-bold"> Código de la solicitud: </span>
          <span> {{ (data$ | async)?.code }}</span>
        </li>
        <li class="d-flex justify-content-between">
          <span class="font-weight-bold"> Solicitante: </span>
          <span> {{ (data$ | async)?.user.name }}</span>
        </li>
        <li class="d-flex justify-content-between">
          <span class="font-weight-bold">Fecha de la solicitud: </span>
          <span> {{ (data$ | async)?.createdAt | date: "dd/MM/yyyy" }}</span>
        </li>
      </ul>

      <ul class="list-unstyled d-inline-block">
        <li class="d-flex justify-content-between">
          <span class="font-weight-bold">Codigo del proyecto: </span>
          <span> {{ (data$ | async)?.project.code }}</span>
        </li>
        <li class="d-flex justify-content-between">
          <span class="font-weight-bold">Coordinador: </span>
          <span>
            {{
              (data$ | async)?.project.coordinator.name
                ? (data$ | async)?.project.coordinator.name
                : "Sin coordinador"
            }}</span
          >
        </li>
        <li class="d-flex justify-content-between">
          <span class="font-weight-bold">Escuela: </span>
          <span>
            {{
              (data$ | async)?.project.school.name
                ? (data$ | async)?.project.school.name
                : "Sin escuela"
            }}</span
          >
        </li>
      </ul>

      <ul class="list-unstyled d-inline-block">
        <li class="d-flex justify-content-between">
          <span class="font-weight-bold">Padrino: </span>
          <span>
            {{
              (data$ | async)?.project.sponsor.name
                ? (data$ | async)?.project.sponsor.name
                : "Sin padrino"
            }}</span
          >
        </li>
      </ul>
    </div>
  </div>

  <hr />

  <!-- Info user -->
  <div id="container-user-historical-preview">
    <p class="text-info font-weight-bold">Información de usuario</p>

    <div class="row">
      <div class="col-12 mb-4">
        <label class="label">Coordinador</label>
        <div class="media">
          <img
            class="mr-3 img-fluid"
            [src]="(data$ | async)?.detail?.coordinator?.image"
            [alt]="(data$ | async)?.detail?.coordinator?.name"
          />
          <div class="media-body">
            <p class="mt-0 font-weight-bold">
              {{
                (data$ | async)?.detail?.coordinator?.name
                  ? (data$ | async)?.detail?.coordinator?.name
                  : "Sin coordinador"
              }}
            </p>
            {{
              (data$ | async)?.detail?.coordinator?.content
                ? (data$ | async)?.detail?.coordinator?.content
                : "Sin contenido"
            }}
          </div>
        </div>
      </div>

      <div class="col-12 mb-4">
        <label class="label">Escuela</label>
        <div class="media">
          <img
            class="mr-3 img-fluid"
            [src]="(data$ | async)?.detail?.school?.image"
            [alt]="(data$ | async)?.detail?.school?.name"
          />
          <div class="media-body">
            <p class="mt-0 font-weight-bold">
              {{
                (data$ | async)?.detail?.school?.name
                  ? (data$ | async)?.detail?.school?.name
                  : "Sin escuela"
              }}
            </p>
            {{
              (data$ | async)?.detail?.school?.content
                ? (data$ | async)?.detail?.school?.content
                : "Sin contenido"
            }}
          </div>
        </div>
      </div>

      <div class="col-12 mb-4">
        <label class="label">Padrino</label>
        <div class="media">
          <img
            class="mr-3 img-fluid"
            [src]="(data$ | async)?.detail?.sponsor?.image"
            [alt]="(data$ | async)?.detail?.sponsor?.name"
          />
          <div class="media-body">
            <p class="mt-0 font-weight-bold">
              {{
                (data$ | async)?.detail?.sponsor?.name
                  ? (data$ | async)?.detail?.sponsor?.name
                  : "Sin padrino"
              }}
            </p>
            {{
              (data$ | async)?.detail?.sponsor?.content
                ? (data$ | async)?.detail?.sponsor?.content
                : "Sin contenido"
            }}
          </div>
        </div>
      </div>

      <div class="col-12 mb-4">
        <label class="label">Reseña histórica</label>
        <div class="media">
          <img
            class="mr-3 img-fluid"
            *ngIf="(data$ | async)?.detail?.historicalReview?.image"
            [src]="(data$ | async)?.detail?.historicalReview?.image"
            [alt]="
              (data$ | async)?.detail?.historicalReview?.name
                ? (data$ | async)?.detail?.historicalReview?.name
                : 'Sin text alternativo'
            "
          />
          <span
            *ngIf="!(data$ | async)?.detail?.historicalReview?.image"
            class="text-warning"
            >Sin imagen</span
          >
          <div class="media-body">
            {{
              (data$ | async)?.detail?.historicalReview?.content
                ? (data$ | async)?.detail?.historicalReview?.content
                : "Sin reseña"
            }}
          </div>
        </div>
      </div>
    </div>

    <div class="d-sm-flex">
      <ul class="list-unstyled d-inline-block">
        <li class="d-md-flex justify-content-between">
          <span class="font-weight-bold"> ¿Está en aprobación?: </span>
          <span> {{ (data$ | async)?.detail.isInApproval ? "Si" : "No" }}</span>
        </li>
      </ul>
      <ul class="list-unstyled d-inline-block">
        <li class="d-md-flex justify-content-between">
          <span class="font-weight-bold"> Última actualización: </span>
          <span>
            {{ (data$ | async)?.detail.updatedAt | date: "dd/MM/yyyy" }}</span
          >
        </li>
      </ul>
    </div>
  </div>

  <hr />

  <!-- Info lapse -->
  <div id="container-lapse">
    <!-- Diagnostic -->
    <div class="row">
      <!-- Lapse One -->
      <div class="col-12">
        <p class="text-info font-weight-bold">
          Análisis de diagnóstico - lapso 1
        </p>
      </div>

      <div class="col-12 form-group">
        <p class="font-weight-bold">Lectura</p>
        {{ (data$ | async)?.detail?.lapse1?.readingDiagnosticAnalysis }}
        <div class="table-responsive mt-3">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th scope="col">Grado</th>
                <th scope="col">Sección</th>
                <th scope="col">Resultado de lectura</th>
                <th scope="col">Índice de lectura</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of (data$ | async)?.detail?.sections">
                <th>{{ item.grade }}</th>
                <td>{{ item.name }}</td>
                <td>{{ item.diagnostics.lapse1.wordsPerMin }}</td>
                <td>{{ item.diagnostics.lapse1.wordsPerMinIndex }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-3">
          <app-graphic-bar
            [barChartData]="dataReadingLapseOne"
            [barChartLabels]="labelLapseOne"
          ></app-graphic-bar>
        </div>
      </div>

      <div class="col-12 form-group">
        <p class="font-weight-bold">Matemáticas</p>
        {{ (data$ | async)?.detail?.lapse1?.mathDiagnosticAnalysis }}
        <div class="table-responsive mt-3">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th scope="col">Grado</th>
                <th scope="col">Sección</th>
                <th scope="col">Resultado de lectura</th>
                <th scope="col">Índice de lectura</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of (data$ | async)?.detail?.sections">
                <th>{{ item.grade }}</th>
                <td>{{ item.name }}</td>
                <td>{{ item.diagnostics.lapse1.multiplicationsPerMin }}</td>
                <td>
                  {{ item.diagnostics.lapse1.multiplicationsPerMinIndex }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-3">
          <app-graphic-bar
            [barChartData]="dataMathLapseOne"
            [barChartLabels]="labelLapseOne"
          ></app-graphic-bar>
        </div>
      </div>
      <div class="col-12 form-group">
        <p class="font-weight-bold">Lógica</p>
        {{ (data$ | async)?.detail?.lapse1?.logicDiagnosticAnalysis }}

        <div class="table-responsive mt-3">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th scope="col">Grado</th>
                <th scope="col">Sección</th>
                <th scope="col">Resultado de lectura</th>
                <th scope="col">Índice de lectura</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of (data$ | async)?.detail?.sections">
                <th>{{ item.grade }}</th>
                <td>{{ item.name }}</td>
                <td>{{ item.diagnostics.lapse1.operationsPerMin }}</td>
                <td>{{ item.diagnostics.lapse1.operationsPerMinIndex }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-3">
          <app-graphic-bar
            [barChartData]="dataLogicLapseOne"
            [barChartLabels]="labelLapseOne"
          ></app-graphic-bar>
        </div>
      </div>
      <!-- / End lapse one -->

      <!-- Lapse Two -->
      <div class="col-12">
        <p class="text-info font-weight-bold">
          Análisis de diagnóstico - lapso 2
        </p>
      </div>

      <div class="col-12 form-group">
        <p class="font-weight-bold">Lectura</p>
        {{ (data$ | async)?.detail?.lapse2?.readingDiagnosticAnalysis }}
        <div class="table-responsive mt-3">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th scope="col">Grado</th>
                <th scope="col">Sección</th>
                <th scope="col">Resultado de lectura</th>
                <th scope="col">Índice de lectura</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of (data$ | async)?.detail?.sections">
                <th>{{ item.grade }}</th>
                <td>{{ item.name }}</td>
                <td>{{ item.diagnostics.lapse2.wordsPerMin }}</td>
                <td>{{ item.diagnostics.lapse2.wordsPerMinIndex }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-3">
          <app-graphic-bar
            [barChartData]="dataReadingLapseTwo"
            [barChartLabels]="labelLapseOne"
          ></app-graphic-bar>
        </div>
      </div>

      <div class="col-12 form-group">
        <p class="font-weight-bold">Matemáticas</p>
        {{ (data$ | async)?.detail?.lapse2?.mathDiagnosticAnalysis }}
        <div class="table-responsive mt-3">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th scope="col">Grado</th>
                <th scope="col">Sección</th>
                <th scope="col">Resultado de lectura</th>
                <th scope="col">Índice de lectura</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of (data$ | async)?.detail?.sections">
                <th>{{ item.grade }}</th>
                <td>{{ item.name }}</td>
                <td>{{ item.diagnostics.lapse2.multiplicationsPerMin }}</td>
                <td>
                  {{ item.diagnostics.lapse2.multiplicationsPerMinIndex }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-3">
          <app-graphic-bar
            [barChartData]="dataMathLapseTwo"
            [barChartLabels]="labelLapseOne"
          ></app-graphic-bar>
        </div>
      </div>
      <div class="col-12 form-group">
        <p class="font-weight-bold">Lógica</p>
        {{ (data$ | async)?.detail?.lapse2?.logicDiagnosticAnalysis }}

        <div class="table-responsive mt-3">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th scope="col">Grado</th>
                <th scope="col">Sección</th>
                <th scope="col">Resultado de lectura</th>
                <th scope="col">Índice de lectura</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of (data$ | async)?.detail?.sections">
                <th>{{ item.grade }}</th>
                <td>{{ item.name }}</td>
                <td>{{ item.diagnostics.lapse2.operationsPerMin }}</td>
                <td>{{ item.diagnostics.lapse2.operationsPerMinIndex }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-3">
          <app-graphic-bar
            [barChartData]="dataLogicLapseTwo"
            [barChartLabels]="labelLapseOne"
          ></app-graphic-bar>
        </div>
      </div>

      <!-- / End lapse two -->

      <div class="col-12">
        <p class="text-info font-weight-bold">
          Análisis de diagnóstico - lapso 3
        </p>
      </div>
      <div class="col-12 form-group">
        <p class="font-weight-bold">Lectura</p>
        {{ (data$ | async)?.detail?.lapse3?.readingDiagnosticAnalysis }}
        <div class="table-responsive mt-3">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th scope="col">Grado</th>
                <th scope="col">Sección</th>
                <th scope="col">Resultado de lectura</th>
                <th scope="col">Índice de lectura</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of (data$ | async)?.detail?.sections">
                <th>{{ item.grade }}</th>
                <td>{{ item.name }}</td>
                <td>{{ item.diagnostics.lapse3.wordsPerMin }}</td>
                <td>{{ item.diagnostics.lapse3.wordsPerMinIndex }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-3">
          <app-graphic-bar
            [barChartData]="dataReadingLapseThree"
            [barChartLabels]="labelLapseOne"
          ></app-graphic-bar>
        </div>
      </div>

      <div class="col-12 form-group">
        <p class="font-weight-bold">Matemáticas</p>
        {{ (data$ | async)?.detail?.lapse3?.mathDiagnosticAnalysis }}
        <div class="table-responsive mt-3">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th scope="col">Grado</th>
                <th scope="col">Sección</th>
                <th scope="col">Resultado de lectura</th>
                <th scope="col">Índice de lectura</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of (data$ | async)?.detail?.sections">
                <th>{{ item.grade }}</th>
                <td>{{ item.name }}</td>
                <td>{{ item.diagnostics.lapse3.multiplicationsPerMin }}</td>
                <td>
                  {{ item.diagnostics.lapse3.multiplicationsPerMinIndex }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-3">
          <app-graphic-bar
            [barChartData]="dataMathLapseThree"
            [barChartLabels]="labelLapseOne"
          ></app-graphic-bar>
        </div>
      </div>
      <div class="col-12 form-group">
        <p class="font-weight-bold">Lógica</p>
        {{ (data$ | async)?.detail?.lapse3?.logicDiagnosticAnalysis }}
        <div class="table-responsive mt-3">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th scope="col">Grado</th>
                <th scope="col">Sección</th>
                <th scope="col">Resultado de lectura</th>
                <th scope="col">Índice de lectura</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of (data$ | async)?.detail?.sections">
                <th>{{ item.grade }}</th>
                <td>{{ item.name }}</td>
                <td>{{ item.diagnostics.lapse3.operationsPerMin }}</td>
                <td>{{ item.diagnostics.lapse3.operationsPerMinIndex }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-3">
          <app-graphic-bar
            [barChartData]="dataLogicLapseThree"
            [barChartLabels]="labelLapseOne"
          ></app-graphic-bar>
        </div>
      </div>
    </div>
    <!-- / End diagnostic -->

    <div class="row">
      <div class="col-xl-4">
        <p class="text-info font-weight-bold">Actividades del lapso 1</p>

        <div
          class="media mb-3"
          *ngFor="let item of (data$ | async)?.detail?.lapse1?.activities"
        >
          <div class="media-body">
            <p class="mt-0 font-weight-bold mb-1">{{ item.name }}</p>
            {{ item.description }}
            <div class="media mt-2">
              <div class="media-body">
                <img
                  *ngFor="let item of item?.images"
                  class="mr-3 mb-3"
                  [src]="item"
                  alt="Imagenes de las actividades"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-xl-4">
        <p class="text-info font-weight-bold">Actividades del lapso 2</p>

        <div
          class="media mb-3"
          *ngFor="let item of (data$ | async)?.detail?.lapse2?.activities"
        >
          <div class="media-body">
            <p class="mt-0 font-weight-bold mb-1">{{ item.name }}</p>
            {{ item.description }}
            <div class="media mt-2">
              <div class="media-body">
                <img
                  *ngFor="let item of item?.images"
                  class="mr-3 mb-3"
                  [src]="item"
                  alt="Imagenes de las actividades"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-xl-4">
        <p class="text-info font-weight-bold">Actividades del lapso 3</p>

        <div
          class="media mb-3"
          *ngFor="let item of (data$ | async)?.detail?.lapse3?.activities"
        >
          <div class="media-body">
            <p class="mt-0 font-weight-bold mb-1">{{ item.name }}</p>
            {{ item.description }}
            <div class="media mt-2">
              <div class="media-body">
                <img
                  *ngFor="let item of item?.images"
                  class="mr-3 mb-3"
                  [src]="item"
                  alt="Imagenes de las actividades"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div>
    <div *ngIf="(data$ | async)?.status === '1' && canEdit">
      <hr />
      <div *ngIf="confirmAction">
        <label class="label"> Acciones para la solicitud</label>
        <select
          [(ngModel)]="statusSelected"
          (change)="statusSelected = $event.target.value"
          class="form-control form-group"
        >
          <option value="2">Aceptar</option>
          <option value="3">Rechazar</option>
        </select>
      </div>

      <app-progress
        *ngIf="showProgress"
        (finish)="showProgress = false"
      ></app-progress>

      <div class="w-100 text-right justify-content-end">
        <button
          class="col-12 col-lg-auto"
          nbButton
          *ngIf="confirmAction"
          status="primary"
          (click)="confirmAction = false"
        >
          Proceder
        </button>

        <div *ngIf="!confirmAction">
          <nb-alert status="info" class="text-left"
            >Confirmar acción, al aprobar o rechazar esta solicitud no se podrá
            cambiar de estatus.</nb-alert
          >

          <div *ngIf="statusSelected === '3'" class="text-left">
            <label class="label">Comentario</label>
            <textarea
              fullWidth
              class="form-group"
              placeholder="Comentario"
              rows="5"
              [(ngModel)]="comment"
              nbInput
            ></textarea>
          </div>

          <div class="row justify-content-end">
            <div class="col-6 col-lg-auto">
              <button
                (click)="onApprovedRequest()"
                nbButton
                fullWidth
                *ngIf="!confirmAction"
                status="danger"
              >
                Confirmar
              </button>
            </div>
            <div class="col-6 col-lg-auto">
              <button
                nbButton
                outline
                fullWidth
                *ngIf="!confirmAction"
                status="basic"
                (click)="confirmAction = true"
              >
                Cancelar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal-footer" *ngIf="data$ | async">
  <button
    aria-label="Close"
    nbButton
    outline
    type="button"
    status="basic"
    (click)="bsModalRef.hide()"
    class="col-12 col-lg-auto"
  >
    Cerrar
  </button>
</div>
